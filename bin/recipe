#! /usr/bin/env php
<?php
/**
 * Parse recipes from the command line. Intended for testing.
 *
 * @package recipe-parser
 */

use SSNepenthe\RecipeParser\Console\Command\ClearCacheCommand;
use SSNepenthe\RecipeParser\Console\Command\ParseCommand;
use Symfony\Component\Console\Application;

$package_root = dirname( __DIR__ );
$package_autoload = sprintf( '%s/vendor/autoload.php', $package_root );
$project_autoload = sprintf(
	'%s/autoload.php',
	dirname( dirname( $package_root ) )
);

function include_if_exists( $file ) {
	if ( file_exists( $file ) ) {
		return include $file;
	}
}

if (
	! include_if_exists( $package_autoload ) &&
	! include_if_exists( $project_autoload )
) {
	die( 'Unable to locate composer autoloader. Please run composer install.' );
}

$app = new Application( 'Recipe Parser', '0.1.0' );
$app->add( new ParseCommand );
$app->add( new ClearCacheCommand );
$app->run();
